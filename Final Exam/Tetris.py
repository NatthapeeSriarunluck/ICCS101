def tetris(grid: list[list[str]]) -> int:
    length_row = list(set([len(i) for i in grid]))
    if len(length_row) != 1:
        raise ValueError('non-rectangle grid is invalid')
    count = 0
    for i in range(len(grid)):
        check = ''
        for j in range(len(grid[i])):
            check += grid[i][j]
        if check in 'x' * len(grid[0]):
            count += 1
    return count

def check_tetris(grid: list[list[str]], expected_output, exception: bool):
    ''' Verifies if `tetris` function works correctly '''
    try:
        assert tetris(grid) == expected_output
    except ValueError:
        return exception
    if exception:
        return False
    return True


grid1 = [
    [' ', ' ', ' ', ' ', ' '],
    [' ', ' ', ' ', 'x', ' '],
    [' ', 'x', ' ', 'x', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', ' ', 'x', ' ', 'x'],
    ['x', ' ', ' ', 'x', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', ' ', 'x', 'x', ' '],
    ['x', 'x', 'x', 'x', 'x'],
]
check_tetris(grid1, 4, False)  # rectangle grid, 4 completed lines

grid2 = [
    [' ', ' ', ' '],
    [' ', ' ', ' ', ' '],
    [' ', 'x', ' ', 'x', ' '],
    ['x', 'x', 'x', 'x', 'x'],
]
check_tetris(grid2, 1, True)  # non-rectangle grid, expecting a ValueError


def check_tetris(grid: list[list[str]], expected_output, exception: bool):
    ''' Verifies if `tetris` function works correctly '''
    try:
        assert tetris(grid) == expected_output
    except ValueError:
        return exception
    if exception:
        return False
    return True


assert check_tetris([['x'], ['x'], ['x'], ['x']], 4, False)
assert check_tetris([['x'], ['x'], ['x'], [' ']], 3, False)
assert check_tetris([['x']], 1, False)
assert check_tetris([
    ['x', 'x'],
    ['x', 'x'],
    ['x', 'x'],
    ['x', 'x']], 4, False)
assert check_tetris([
    [' ', ' ', ' '],
    ['x', 'x', 'x'],
    ['x', ' ', ' '],
    ['x', 'x', 'x'],
    [' ', ' ', ' '],
    [' ', ' ', ' ']], 2, False)
assert check_tetris([
    ['x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x']], 7, False)
assert check_tetris([
    [' ', ' ', ' ', 'x', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', 'x', ' ', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', 'x', ' '],
    [' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ']], 2, False)
assert check_tetris([
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']], 1, False)
assert check_tetris([
    [' ', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' '],
    [' ', ' ', ' ', 'x', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', ' '],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', ' ', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x'],
    ['x', 'x', ' ', 'x', ' '],
    [' ', ' ', ' ', 'x', 'x']], 10, False)
assert check_tetris([
    ['x', 'x', 'x', ' ', ' ', 'x', 'x', 'x'],
    [' ', ' ', ' ', 'x', ' '],
    ['x', 'x', 'x', 'x', ' ', ' ', ' ', ' ', ' ', ' '],
    ['x', ' ', 'x', 'x', 'x', ' '],
    ['x'],
    [' ', 'x'],
    [' ', ' ', ' ', 'x', 'x', ' ', 'x', 'x'],
    [' ', ' '],
    ['x'],
    ['x', ' ', ' ', ' ', 'x', ' ', ' ', 'x', 'x', ' ']], 0, True)  # Non-rectangle
assert check_tetris([
    [' ', 'x', 'x', ' ', ' ', ' ', 'x'],
    ['x', 'x', ' ', ' ', ' ', ' '],
    ['x', 'x', ' ', 'x', 'x', ' ', 'x'],
    [' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', ' ', ' '],
    ['x', 'x', ' ', 'x']], 0, True)  # Non-rectangle

assert check_tetris([
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x'],
    ['x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', ' ', 'x', 'x', 'x', 'x'],
    [' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x', 'x'],
    ['x', 'x', ' ', ' ', 'x', ' ', 'x', ' ', ' ', ' ', 'x', 'x', ' ', ' ', 'x'],
    ['x', ' ', 'x', ' ', 'x', ' ', 'x', ' ', ' ', 'x', 'x', 'x', 'x', 'x', 'x'],
    [' ', ' ', ' ', ' ', 'x', 'x', ' ', ' ', ' ', ' ', 'x', ' ', ' ', ' ', 'x'],
    ['x', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '],
    [' ', 'x', ' ', ' ', ' ', ' ', ' ', ' ', 'x', ' ', ' ', 'x', ' ', ' ', ' '],
    [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
], 11, False)